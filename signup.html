<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TrustVest - Sign Up</title>
  <script src="https://www.gstatic.com/firebasejs/10.3.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.3.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.3.1/firebase-firestore.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/lucide@latest/dist/umd/lucide.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-black text-white">

  <!-- 🔵 Spinner Overlay -->
  <div id="spinner" class="fixed inset-0 bg-black flex items-center justify-center z-50 hidden">
    <img src="https://raw.githubusercontent.com/ayubaboluwatife246/assets/main/trustvest-logo.png"
         class="w-20 h-20 animate-bounce" alt="Loading..." />
  </div>

  <!-- 🔶 Sign Up Container -->
  <div class="min-h-screen flex items-center justify-center px-4">
    <div class="bg-[#111] p-6 rounded-2xl shadow-lg w-full max-w-md">

      <!-- 🔶 Logo + Title -->
      <img src="https://raw.githubusercontent.com/ayubaboluwatife246/assets/main/trustvest-logo.png"
           class="w-20 h-20 mx-auto mb-4 animate-bounce" alt="TrustVest Logo" />
      <h2 class="text-center text-xl font-semibold mb-6">Create Your TrustVest Account</h2>

      <!-- 🔶 Signup Form -->
      <form id="signupForm" class="space-y-4">
        <input type="text" id="fullname" placeholder="Full Name" required
               class="w-full px-4 py-2 rounded-lg bg-[#222] text-white placeholder-gray-400 focus:outline-none" />

        <input type="email" id="email" placeholder="Email Address" required
               class="w-full px-4 py-2 rounded-lg bg-[#222] text-white placeholder-gray-400 focus:outline-none" />

        <input type="text" id="username" placeholder="Username" required
               class="w-full px-4 py-2 rounded-lg bg-[#222] text-white placeholder-gray-400 focus:outline-none" />

        <!-- 🔐 Password Field with Stroke Icon -->
        <div class="relative">
          <input type="password" id="password" placeholder="Password" required
                 class="w-full px-4 py-2 rounded-lg bg-[#222] text-white placeholder-gray-400 focus:outline-none pr-10" />
          <div onclick="togglePassword('password', this)"
               class="absolute top-2 right-3 text-gray-400 cursor-pointer">
            <i data-lucide="eye" class="w-5 h-5"></i>
          </div>
        </div>

        <!-- 🔐 Retype Password -->
        <div class="relative">
          <input type="password" id="retype" placeholder="Retype Password" required
                 class="w-full px-4 py-2 rounded-lg bg-[#222] text-white placeholder-gray-400 focus:outline-none pr-10" />
          <div onclick="togglePassword('retype', this)"
               class="absolute top-2 right-3 text-gray-400 cursor-pointer">
            <i data-lucide="eye" class="w-5 h-5"></i>
          </div>
        </div>

        <!-- 🔶 Sign Up Button -->
        <button type="submit"
                class="w-full py-2 rounded-lg bg-gradient-to-r from-amber-500 to-yellow-400 text-black font-semibold hover:opacity-90 transition">
          Create Account
        </button>
      </form>
    </div>
  </div>

  <!-- 🔧 Firebase Configuration -->
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCH5H1FWEcHmQiCQhoc6GE8GhizqhTZoQc",
      authDomain: "finsa-connect.firebaseapp.com",
      projectId: "finsa-connect",
      storageBucket: "finsa-connect.appspot.com",
      messagingSenderId: "126845965255",
      appId: "1:126845965255:web:c82539297a8464873d7fe2"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();
  </script>

  <!-- 🧠 Logic for Signup -->
  <script>
    lucide.createIcons();

    const form = document.getElementById("signupForm");
    const spinner = document.getElementById("spinner");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      spinner.classList.remove("hidden");

      const fullName = document.getElementById("fullname").value.trim();
      const email = document.getElementById("email").value.trim();
      const username = document.getElementById("username").value.trim();
      const password = document.getElementById("password").value;
      const retype = document.getElementById("retype").value;

      if (password !== retype) {
        alert("Passwords do not match.");
        spinner.classList.add("hidden");
        return;
      }

      try {
        const userCredential = await auth.createUserWithEmailAndPassword(email, password);
        const uid = userCredential.user.uid;

        await db.collection("Users").doc(uid).set({
          fullName,
          email,
          username,
          createdAt: new Date(),
          role: "user"
        });

        alert("Account created successfully!");
        window.location.href = "dashboard.html";
      } catch (error) {
        alert("Error: " + error.message);
      }

      spinner.classList.add("hidden");
    });

    function togglePassword(fieldId, toggleEl) {
      const input = document.getElementById(fieldId);
      const icon = toggleEl.querySelector("i");
      const isHidden = input.type === "password";
      input.type = isHidden ? "text" : "password";
      icon.setAttribute("data-lucide", isHidden ? "eye-off" : "eye");
      lucide.createIcons();
    }
  </script>

</body>
</html>
